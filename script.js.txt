document.addEventListener("DOMContentLoaded", function () {
    const sections = document.querySelectorAll("section");

    function revealOnScroll() {
        sections.forEach(section => {
            const sectionTop = section.getBoundingClientRect().top;
            if (sectionTop < window.innerHeight - 100) {
                section.classList.add("active");
            }
        });
    }

    window.addEventListener("scroll", revealOnScroll);
    revealOnScroll();

    const savedLang = localStorage.getItem("selectedLanguage") || "vi";
    changeLanguage(savedLang);
});

document.addEventListener("mousemove", function (event) {
    const x = (event.clientX / window.innerWidth) * 100;
    const y = (event.clientY / window.innerHeight) * 100;
    document.body.style.setProperty("--x", x + "%");
    document.body.style.setProperty("--y", y + "%");
});

const translations = {
    vi: {
        title: "LÃ ng Nghá» Truyá»n Thá»‘ng Báº¿n Tre",
        craftTitle: "Danh SÃ¡ch CÃ¡c LÃ ng Nghá»",
        villages: [
            {
                name: "1. LÃ ng Nghá» Káº¹o Dá»«a (XÃ£ SÆ¡n ÄÃ´ng, TP. Báº¿n Tre)",
                formed: "HÃ¬nh thÃ nh tá»«: Äáº§u tháº¿ ká»· 20.",
                process: "CÃ¡ch lÃ m: Dá»«a tÆ°Æ¡i Ä‘Æ°á»£c náº¡o cÆ¡m, Ã©p láº¥y nÆ°á»›c cá»‘t, náº¥u vá»›i Ä‘Æ°á»ng vÃ  máº¡ch nha.",
                feature: "Äáº·c trÆ°ng: Káº¹o dá»«a dáº»o, thÆ¡m tá»± nhiÃªn.",
                meaning: "Ã nghÄ©a: Thá»ƒ hiá»‡n sá»± sÃ¡ng táº¡o vÃ  táº­n dá»¥ng nguá»“n nguyÃªn liá»‡u sáºµn cÃ³ cá»§a ngÆ°á»i dÃ¢n."
            },
            {
                name: "2. LÃ ng Nghá» Thá»§ CÃ´ng Má»¹ Nghá»‡ Tá»« Dá»«a (XÃ£ Há»¯u Äá»‹nh, Huyá»‡n ChÃ¢u ThÃ nh)",
                formed: "HÃ¬nh thÃ nh tá»«: HÆ¡n 100 nÄƒm trÆ°á»›c.",
                process: "CÃ¡ch lÃ m: GÃ¡o dá»«a Ä‘Æ°á»£c cháº¡m kháº¯c thÃ nh cá»‘c, chÃ©n, tÆ°á»£ng nghá»‡ thuáº­t.",
                feature: "Äáº·c trÆ°ng: Sáº£n pháº©m bá»n, Ä‘áº¹p.",
                meaning: "Ã nghÄ©a: Táº­n dá»¥ng tá»‘i Ä‘a cÃ¢y dá»«a, giÃºp phÃ¡t triá»ƒn kinh táº¿ bá»n vá»¯ng."
            },
            {
                name: "3. LÃ ng Nghá» Dá»‡t Chiáº¿u (XÃ£ NhÆ¡n Tháº¡nh, TP. Báº¿n Tre)",
                formed: "HÃ¬nh thÃ nh tá»«: HÆ¡n 200 nÄƒm.",
                process: "CÃ¡ch lÃ m: Sá»­ dá»¥ng cÃ³i vÃ  lÃ¡c Ä‘á»ƒ dá»‡t thá»§ cÃ´ng thÃ nh chiáº¿u.",
                feature: "Äáº·c trÆ°ng: Chiáº¿u dá»‡t bá»n, hoa vÄƒn Ä‘áº¹p.",
                meaning: "Ã nghÄ©a: GÃ¬n giá»¯ nghá» truyá»n thá»‘ng lÃ¢u Ä‘á»i, gáº¯n liá»n vá»›i Ä‘á»i sá»‘ng ngÆ°á»i Viá»‡t."
            },
            {
                name: "4. LÃ ng Nghá» LÃ m BÃ¡nh TrÃ¡ng (XÃ£ PhÃº NgÃ£i, Huyá»‡n Ba Tri)",
                formed: "HÃ¬nh thÃ nh tá»«: HÆ¡n 150 nÄƒm.",
                process: "CÃ¡ch lÃ m: Bá»™t gáº¡o pha nÆ°á»›c, trÃ¡ng má»ng, phÆ¡i khÃ´.",
                feature: "Äáº·c trÆ°ng: BÃ¡nh trÃ¡ng thÆ¡m, dáº»o.",
                meaning: "Ã nghÄ©a: ÄÃ³ng gÃ³p vÃ o áº©m thá»±c truyá»n thá»‘ng, táº¡o viá»‡c lÃ m cho nhiá»u há»™ gia Ä‘Ã¬nh."
            },
            {
                name: "5. LÃ ng Nghá» Äan LÃ¡t (XÃ£ An Tháº¡nh, Huyá»‡n Má» CÃ y Nam)",
                formed: "HÃ¬nh thÃ nh tá»«: HÆ¡n 100 nÄƒm.",
                process: "CÃ¡ch lÃ m: Sá»­ dá»¥ng tre, trÃºc Ä‘á»ƒ Ä‘an thÃ nh rá»•, rÃ¡, giá».",
                feature: "Äáº·c trÆ°ng: Sáº£n pháº©m cháº¯c cháº¯n, Ä‘áº¹p.",
                meaning: "Ã nghÄ©a: Táº­n dá»¥ng nguyÃªn liá»‡u tá»± nhiÃªn, giÃºp báº£o vá»‡ mÃ´i trÆ°á»ng."
            }
        ],
        comments: "BÃ¬nh luáº­n",
        sendMessage: "Gá»­i",
        contact: "LiÃªn há»‡",
        zalo: "Nháº¯n tin Zalo"
    },
    en: {
        title: "Ben Tre Traditional Craft Villages",
        craftTitle: "List of Craft Villages",
        villages: [
            {
                name: "1. Coconut Candy Village (Son Dong, Ben Tre City)",
                formed: "Established: Early 20th century.",
                process: "Process: Fresh coconut is grated, squeezed for milk, and cooked with sugar and malt.",
                feature: "Feature: Soft, naturally fragrant coconut candy.",
                meaning: "Significance: Represents creativity and the utilization of local resources."
            },
            {
                name: "2. Coconut Handicraft Village (Huu Dinh, Chau Thanh District)",
                formed: "Established: Over 100 years ago.",
                process: "Process: Coconut shells are carved into cups, bowls, and artistic statues.",
                feature: "Feature: Durable and beautiful products.",
                meaning: "Significance: Maximizes the use of coconut trees, promoting sustainable economic growth."
            },
            {
                name: "3. Mat Weaving Village (Nhon Thanh, Ben Tre City)",
                formed: "Established: Over 200 years ago.",
                process: "Process: Reed and rush are woven into traditional mats.",
                feature: "Feature: Durable mats with beautiful patterns.",
                meaning: "Significance: Preserves a long-standing craft deeply connected to Vietnamese culture."
            },
            {
                name: "4. Rice Paper Village (Phu Ngai, Ba Tri District)",
                formed: "Established: Over 150 years ago.",
                process: "Process: Rice flour is mixed with water, spread thinly, and dried.",
                feature: "Feature: Fragrant and chewy rice paper.",
                meaning: "Significance: Contributes to traditional Vietnamese cuisine and provides jobs for many families."
            },
            {
                name: "5. Bamboo Weaving Village (An Thanh, Mo Cay Nam District)",
                formed: "Established: Over 100 years ago.",
                process: "Process: Bamboo and rattan are woven into baskets, trays, and bags.",
                feature: "Feature: Strong and aesthetically pleasing products.",
                meaning: "Significance: Utilizes natural materials and promotes environmental sustainability."
            }
        ],
        comments: "Comments",
        sendMessage: "Send",
        contact: "Contact",
        zalo: "Message on Zalo"
    }
};

function changeLanguage(lang) {
    localStorage.setItem("selectedLanguage", lang);
    document.getElementById("page-title").textContent = translations[lang].title;
    document.querySelector("#craft-villages h2").textContent = translations[lang].craftTitle;
    document.querySelector("#comments h2").textContent = translations[lang].comments;
    document.querySelector("#contact h2").textContent = translations[lang].contact;
    document.querySelector(".zalo-button").textContent = translations[lang].zalo;
    document.querySelector("#chatbox button").textContent = translations[lang].sendMessage;

    let villageItems = document.querySelectorAll(".village-item");
    translations[lang].villages.forEach((village, index) => {
        if (villageItems[index]) {
            villageItems[index].querySelector("h3").textContent = village.name;
            villageItems[index].querySelectorAll("p")[0].textContent = village.formed;
            villageItems[index].querySelectorAll("p")[1].textContent = village.process;
            villageItems[index].querySelectorAll("p")[2].textContent = village.feature;
            villageItems[index].querySelectorAll("p")[3].textContent = village.meaning;
        }
    });
}

document.addEventListener("DOMContentLoaded", function () {
    // Hiá»‡u á»©ng cuá»™n hiá»‡n pháº§n tá»­
    const sections = document.querySelectorAll("section");
    function revealOnScroll() {
        sections.forEach(section => {
            const sectionTop = section.getBoundingClientRect().top;
            if (sectionTop < window.innerHeight - 100) {
                section.classList.add("active");
            }
        });
    }
    window.addEventListener("scroll", revealOnScroll);
    revealOnScroll();

    // LÆ°u vÃ  khÃ´i phá»¥c ngÃ´n ngá»¯
    const savedLang = localStorage.getItem("selectedLanguage") || "vi";
    changeLanguage(savedLang);

    // Load bÃ¬nh luáº­n khi má»Ÿ trang
    loadComments();
});

// ðŸ“ HÃ m gá»­i tin nháº¯n
function sendMessage() {
    let username = document.getElementById("username").value.trim();
    let message = document.getElementById("message").value.trim();

    if (username === "" || message === "") {
        alert("Vui lÃ²ng nháº­p tÃªn vÃ  ná»™i dung bÃ¬nh luáº­n!");
        return;
    }

    let chatbox = document.getElementById("messages");

    // Táº¡o pháº§n tá»­ bÃ¬nh luáº­n má»›i
    let newComment = document.createElement("div");
    newComment.classList.add("comment-item");
    newComment.innerHTML = `<strong>${username}:</strong> ${message}`;

    // ThÃªm bÃ¬nh luáº­n vÃ o danh sÃ¡ch
    chatbox.appendChild(newComment);

    // LÆ°u vÃ o LocalStorage
    saveComment(username, message);

    // XÃ³a ná»™i dung nháº­p
    document.getElementById("username").value = "";
    document.getElementById("message").value = "";
}

// ðŸ—„ï¸ LÆ°u bÃ¬nh luáº­n vÃ o LocalStorage
function saveComment(username, message) {
    let comments = JSON.parse(localStorage.getItem("comments")) || [];
    comments.push({ username, message });
    localStorage.setItem("comments", JSON.stringify(comments));
}

// ðŸ”„ Load bÃ¬nh luáº­n tá»« LocalStorage
function loadComments() {
    let chatbox = document.getElementById("messages");
    chatbox.innerHTML = ""; // XÃ³a ná»™i dung cÅ©
    let comments = JSON.parse(localStorage.getItem("comments")) || [];

    comments.forEach(comment => {
        let newComment = document.createElement("div");
        newComment.classList.add("comment-item");
        newComment.innerHTML = `<strong>${comment.username}:</strong> ${comment.message}`;
        chatbox.appendChild(newComment);
    });
}